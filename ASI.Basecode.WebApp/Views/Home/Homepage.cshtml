@model ASI.Basecode.Services.ServiceModels.HomepageViewModel
@using ASI.Basecode.Data.Models
@using System.Linq
@using static ASI.Basecode.Resources.Views.Screen
@section Styles {
    <link rel="stylesheet" href="~/css/headerfinal.css" />
    <link rel="stylesheet" href="~/css/texts.css" />
    <link rel="stylesheet" href="~/css/homepage.css" />
    <link rel="stylesheet" href="~/css/homepagetable.css" />
    <link rel="stylesheet" href="~/css/booking-modal.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link rel="icon" type="image/svg+xml" href="~/img/logo-invert.svg">
}
<!--copy ang script-->
@section Scripts {
    <script src="~/js/modal.js"></script>  
    <script src="~/js/booking-operations.js"></script>
}
@{
    ViewBag.LoginView = true;
    ViewData["Title"] = "Dashboard";
}
<div class= "custom-main-container">
    <!--search -->
    <div class="custom-box">
    <input placeholder="Search...">
    <button><i class="fa-solid fa-magnifying-glass"></i></button>
    </div>
  <div class = "custom-search-filter-container">
    <div class= "home-page-title">
    <span class="page-title">Dashboard</span>
  </div>
    <!-- Filter and show all -->
    <div class="custom-filter-box">
       <!-- filter-->
        <span class="custom-main-text-normal">Sort by:</span>
        <div class="custom-filter-select custom-main-text-normal" id="dropdown">
          <span>Date Reserved</span>
          <button><i class="fa-solid fa-caret-down"></i></button>
          <ul class="custom-filter-options custom-main-text-normal"> 
            <li class="custom-filter-options-li">Date Reserved</li>
            <li class="custom-filter-options-li">Guest Name</li>
            <li class="custom-filter-options-li">Point of Contact</li>
            <li class="custom-filter-options-li">Room Name</li>
        </ul>
        </div> 
        <!-- show  -->
        <div class= "show-box custom-main-text-normal"><span>Show:</span>
        <div class="custom-show-select custom-main-text-normal" id="dropdown">
        <span>All</span>
        <button><i class="fa-solid fa-caret-down"></i></button>
        <ul class="custom-show-options custom-main-text-normal"> 
            <li class="custom-show-options-li">All</li>
            <li class="custom-show-options-li">Vacant</li>
            <li class="custom-show-options-li">Occupied</li>
            <li class="custom-show-options-li">Reserved</li>
        </ul>   
      </div>
      </div>
    </div> 
  </div>
  <!--end-->

  <!--home table-->
  <div class="custom-table-container">
    <div class="dash-table">
      <table>
          <thead class = "th-text">
            <tr>
                <th>Status</th>
                <th>Room Name</th>
                <th>Capacity</th>
                <th>Guest Name</th>
                <th>Date Reserved</th>
                <th>Start Session</th>
                <th>End Session</th>
          </tr>
          </thead>

                <!--start sa content sa table-->
                <tbody class="td-text">
                  @foreach (var room in Model.Rooms)
                  {
                      var booking = Model.Bookings.FirstOrDefault(b => b.RoomId == room.Id);
                      var status = Model.RoomStatuses[room.Id];
                      
                      <tr onclick="openBookingModal(@room.Id)">
                          <td>
                              <p class="status status-@status.ToLower()-text status-@status.ToLower()">
                                  @status
                              </p>
                          </td>
                          <td>@room.Roomname</td>
                          <td>@room.MaxCapacity</td>
                          <td>@(booking?.Customer?.Custfname ?? "--")</td>
                          <td>@(booking?.BookingDate?.ToString("MM/dd/yyyy") ?? "--")</td>
                          <td>@(booking?.TimeIn?.ToString() ?? "--")</td>
                          <td>@(booking?.TimeOut?.ToString() ?? "--")</td>
                      </tr>
                  }
                </tbody>
      </table>
    </div>
  </div>
  <div class="custom-add-container">
    <button class="add-booking-btn custom-main-white-text-normal" id="addUserForm" onclick="openModal()""><span>Add booking</span></button>
  </div>

 <!--modal html, copy ni-->
<div id="myModal" class="booking-modal">
    <div class="booking-modal-content">
        <span class="booking-close" onclick="closeModal()">&times;</span>
        <div class="booking-form-section">
            <h3>Add New Booking</h3>
            <form id="bookingForm" onsubmit="addBooking(event)">
                <div class="booking-form-group">
                    <label class="booking-label">Room</label>
                    <select id="roomSelect" name="roomId" class="booking-select" required>
                        <option value="">Select a room</option>
                    </select>
                </div>

                <div class="booking-form-group">
                    <label class="booking-label">Date</label>
                    <input type="date" id="bookingDate" name="bookingDate" 
                           class="booking-input" required>
                </div>

                <div class="booking-form-group">
                    <label class="booking-label">Start Time</label>
                    <select id="timeIn" name="timeIn" class="booking-select" required>
                        <option value="">Select start time</option>
                    </select>
                </div>

                <div class="booking-form-group">
                    <label class="booking-label">End Time</label>
                    <select id="timeOut" name="timeOut" class="booking-select" required>
                        <option value="">Select end time</option>
                    </select>
                </div>

                <div class="booking-form-group">
                    <label class="booking-label">Guest Name</label>
                    <input type="text" id="guestName" name="guestName" 
                           class="booking-input" required>
                </div>

                <div class="booking-form-group">
                    <label class="booking-label">Contact Number</label>
                    <input type="tel" id="contactNumber" name="contactNumber" 
                           class="booking-input" required>
                </div>

                <div class="booking-btn-group">
                    <button type="button" class="booking-btn booking-btn-cancel" 
                            onclick="closeModal()">Cancel</button>
                    <button type="submit" class="booking-btn booking-btn-submit">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>


