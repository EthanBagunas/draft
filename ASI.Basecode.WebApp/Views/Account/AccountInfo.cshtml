@model IEnumerable<ASI.Basecode.Data.Models.User>

@using System.Collections.Generic
@using static ASI.Basecode.Resources.Views.Screen
@using System.ComponentModel.DataAnnotations
@section Styles {
    <link rel="stylesheet" href="~/css/headerfinal.css" />
    <link rel="stylesheet" href="~/css/texts.css" />
    <link rel="stylesheet" href="~/css/style.css" />
    <link rel="stylesheet" href="~/css/admin-info.css" />
    <link rel="stylesheet" href="~/css/homepage.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link rel="icon" type="image/svg+xml" href="~/img/logo-invert.svg">
}
<!--copy ang script-->
@section Scripts {
    <script src="~/js/user-operations.js"></script>
    <script>
    document.getElementById('addUserForm').addEventListener('submit', function(event) {
    event.preventDefault();
    const password = document.getElementById('Password').value;
    const confirmPassword = document.getElementById('ConfirmPassword').value;
    if (password === confirmPassword) {
        // Submit the form
        this.submit();
    } else {
        alert('Passwords do not match.');
    }
});
document.getElementById('editUserForm').addEventListener('submit', editUser);
function editUser(event) {
    event.preventDefault();
    const uid = document.getElementById('uid').value;
    const firstName = document.getElementById('efirstname').value;
    const lastName = document.getElementById('elastname').value;
    const email = document.getElementById('euserid').value;
    const contactNumber = document.getElementById('econtactNumber').value;
    const password = document.getElementById('epassword').value;
    const name = firstName + ' ' + lastName;
    $.ajax({
        url: '/Account/UpdateUser/', // Adjust the URL as needed
        type: 'POST',
        data: {
            Id: uid,
            Name: name,
            UserId: email,
            Contact: contactNumber,
            Fname: firstName,
            Lname: lastName,
            Password: password
        },
        success: function() {
            location.reload(); // Reload the page to see the changes
        },
        error: function(error) {
            console.error('Error editing user:', error);
        }
    });
}
function deleteUser(userId) {
    if (confirm('Are you sure you want to delete this user?')) {
        $.ajax({
            url: `/Account/DeleteUser/`, // Adjust the URL as needed
            type: 'POST',
            data: {Id: userId},
            success: function() {
                location.reload(); // Reload the page to see the changes
            },
            error: function(error) {
                console.error('Error deleting user:', error);
            }
        });
    }
}


function openCreateModal() {
    const modal = document.getElementById('createModal');
    modal.classList.add('show');
    document.body.classList.add('modal-open');
}


function closeCreateModal() {
    const modal = document.getElementById('createModal');
    modal.classList.remove('show');
    document.body.classList.remove('modal-open');
}

// Close modal when clicking outside
window.onclick = function(event) {
    const modal = document.getElementById('createModal');
    if (event.target === modal) {
        closeCreateModal();
    }
}
function openEditModal(userid) {
    document.getElementById('uid').value = userid;
    const modal = document.getElementById('editModal');
    modal.classList.add('show');
    document.body.classList.add('modal-open');
}


function closeEditModal() {
    const modal = document.getElementById('editModal');
    modal.classList.remove('show');
    document.body.classList.remove('modal-open');
}

// Close modal when clicking outside
window.onclick = function(event) {
    const modal = document.getElementById('editModal');
    if (event.target === modal) {
        closeEditModal();
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const searchInput = document.getElementById('searchInput');

    searchInput.addEventListener('keyup', function () {
        const searchValue = this.value.toLowerCase().trim(); // Trim input for consistency
        const rows = document.querySelectorAll('.info-table tbody tr');

        rows.forEach(row => {
            const nameCell = row.cells[1].textContent.toLowerCase().trim();
            if (nameCell.includes(searchValue)) {
                row.style.display = ''; // Show matching rows
            } else {
                row.style.display = 'none'; // Hide non-matching rows
            }
        });
    });
});

</script>
}
    
@{
    ViewBag.LoginView = true;
    ViewData["Title"] = "Account Information";
}

<div class= "custom-main-container">
    <!--search -->
    <div class="custom-info-box">
        <input id="searchInput" placeholder="Search by name...">
        <button id="searchButton"><i class="fa-solid fa-magnifying-glass"></i></button>
    </div>
        <div class ="custom-info-search-container">
        <div class = "info-page-title">
        <span class="page-title">Account Information</span>
        </div>

    </div>

    <!--table-->
    <div class="info-table-container">
        <div class="info-table">
            <table>
                <thead class="th-text">
                    <tr>
                        <th>Employee ID</th>
                        <th>Full Name</th>
                        <th>UserName</th>
                        <th>Contact Number</th>
                        <th>Tools</th>
                    </tr>
                </thead>
                <!--start sa content sa table-->
                <tbody class="td-text">
                    @foreach (var user in Model)
                    {
                        <tr>
                            <td>@user.Id</td>
                            <td>@user.Name</td>
                            <td>@user.UserId</td>
                            <td>@user.Contact</td>
                            <td>
                                <div class="grid-item-toolbar">
                                    <button type='button' id='editbtn' class="grid-toolbar-button" onclick="openEditModal(@user.Id)">
                                        <i class="fa-regular fa-pen-to-square"></i>
                                    </button>
                                    <button type='button' id='delbtn' class="grid-toolbar-button" onclick="deleteUser(@user.Id)">
                                        <i class="fa-regular fa-trash-can" style="color: #b3261e;"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
        </table>
    </div>
</div>
    <div class="custom-bottom-container">
        <div class="results-info">
        Showing 1 out of 10 results
        </div>
        <div class="custom-pagination-container">
            <div class="custom-pagination-btn">
            <!-- Pagination will be populated by JavaScript -->
            </div>
        </div>
        <div class="info-room-add-container">
            <button class="info-add-booking-btn custom-main-white-text-normal" onclick="openCreateModal()">Add New User</button>
        </div>    
    </div>

 
       
 <!--modal html, copy ni-->
<div id="createModal" class="modal">
    <div class="modal-content">
        <div class="modal-header1">
            <h1>Add User</h1>
        </div>
        <form id="addUserForm" action="/Account/CreateUser/" method="post">
            <label for="Fname">First Name </label>
            <input type="text" id="Fname" name="Fname" placeholder="Enter first name" required>
            <label for="Lname">Last Name </label>
            <input type="text" id="Lname" name="Lname" placeholder="Enter last name" required>
            <label for="UserId">Email </label>
            <input type="text" id="UserId" name="UserId" placeholder="Enter email" required>
            <label for="Contact">Contact Number </label>
            <input type="text" id="Contact" name="Contact" placeholder="Enter contact number" required>
            <label for="Password">Password </label>
            <input type="password" id="Password" name="Password" placeholder="Enter password" required>
            <label for="ConfirmPassword">Confirm Password </label>
            <input type="password" id="ConfirmPassword" name="ConfirmPassword" placeholder="Confirm password" required>
            <div class="modal-footer1">
                <button type="button" class="user-info-btn user-info-btn-cancel" onclick="closeCreateModal()">Cancel</button>
                <button id="createbtn" type="submit" class="user-info-btn user-info-btn-submit">Submit</button>
            </div>
        </form>
    </div>
</div>
<div id="editModal" class="modal">
    <div class="modal-content">
        <div class="modal-header1">
            <h2>Add User</h2>
        </div>
        <form id="editUserForm">
                <label for="uid">Id </label>
                <input type="text" id="uid" name="uid" readonly>
                <label for="firstname">First Name </label>
                <input type="text" id="efirstname" name="firstname" placeholder="Enter first name" required>
                <label for="lastname">Last Name </label>
                <input type="text" id="elastname" name="lastname" placeholder="Enter last name" required>
                
                <label for="euserid">Email </label>
                <input type="text" id="euserid" name="euserid" placeholder="Enter new email" required>

                <label for="econtactNumber">Contact Number </label>
                <input type="text" id="econtactNumber" name="econtactNumber" placeholder="Enter contact number" required>
                <label for="epassword">Password </label>
                <input type="text" id="epassword" name="epassword" placeholder="Enter contact number" required>
            <div class="modal-footer1">
                <button type="button" class="cancel-bttn" onclick="closeEditModal()">Cancel</button>
                <button type="submit" class="submit-bttn">Submit</button>
            </div>
        </form>
    </div>
</div>


<script>

</script>



